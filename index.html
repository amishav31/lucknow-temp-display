<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lucknow Weather</title>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    /* styles same as you provided (keeping unchanged for brevity) */
    /* ... Keep all your existing CSS here ... */
  </style>
</head>
<body>
  <div class="card">
    <div id="weather-icon">‚òÄÔ∏è</div>
    <h1>Lucknow Weather</h1>
    <div class="loader" id="loader"></div>
    <div id="temperature" style="display: none;"></div>
    <div id="time"></div>
    <div id="aqi">AQI: Loading...</div>
    <div id="refresh-note">Updates every 5 mins ‚è±Ô∏è</div>
  </div>

  <script>
    async function fetchTemperature() {
      const url = "https://api.open-meteo.com/v1/forecast?latitude=26.8467&longitude=80.9462&current_weather=true";

      try {
        const response = await fetch(url);
        const data = await response.json();
        const temp = data.current_weather.temperature;

        const tempDiv = document.getElementById("temperature");
        tempDiv.innerText = `${temp}¬∞C`;
        tempDiv.style.display = "block";
        document.getElementById("loader").style.display = "none";

        // Change icon based on time
        const hour = new Date().getHours();
        const icon = document.getElementById("weather-icon");
        icon.innerText = (hour >= 6 && hour <= 18) ? '‚òÄÔ∏è' : 'üåô';

        // Set current time
        const now = new Date();
        document.getElementById("time").innerText = `As of: ${now.toLocaleTimeString()}`;
      } catch (error) {
        const tempDiv = document.getElementById("temperature");
        tempDiv.innerText = "‚ö†Ô∏è Unable to load";
        tempDiv.style.display = "block";
        document.getElementById("loader").style.display = "none";
        console.error("Temperature error:", error);
      }
    }

    async function fetchAQI() {
      const url = "https://air-quality-api.open-meteo.com/v1/air-quality?latitude=26.8467&longitude=80.9462&hourly=pm2_5";

      try {
        const response = await fetch(url);
        const data = await response.json();
        const pm25 = data.hourly.pm2_5[0];

        const aqiValue = calculateAQI(pm25);
        document.getElementById("aqi").innerText = `AQI: ${aqiValue}`;
      } catch (error) {
        document.getElementById("aqi").innerText = "AQI: N/A";
        console.error("AQI error:", error);
      }
    }

    function calculateAQI(pm) {
      if (pm <= 12) return "Good üü¢";
      if (pm <= 35.4) return "Moderate üü°";
      if (pm <= 55.4) return "Unhealthy for Sensitive üü†";
      if (pm <= 150.4) return "Unhealthy üî¥";
      if (pm <= 250.4) return "Very Unhealthy üü£";
      return "Hazardous ‚ö´";
    }

    // Load initially and every 5 mins
    fetchTemperature();
    fetchAQI();
    setInterval(() => {
      fetchTemperature();
      fetchAQI();
    }, 5 * 60 * 1000);
  </script>
</body>
</html>
